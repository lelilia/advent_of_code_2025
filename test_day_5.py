import pytest
from day_5 import part_1, part_2

with open("input5") as f:
    REAL_DATA = f.read()


@pytest.mark.parametrize(
    "data, exp",
    (
        ("3-5\n10-14\n16-20\n12-18\n\n1\n5\n8\n11\n17\n32", 3),
        ("18-100\n3-5\n10-14\n16-20\n12-18\n\n1\n5\n8\n11\n17\n32", 4),
        ("18-100\n3-5\n10-14\n16-20\n12-18\n\n1\n5\n8\n11\n17\n32\n99", 5),
        (REAL_DATA, 563),
    ),
)
def test_day_5_part_1(data, exp):
    assert (res := part_1(data)) == exp, f"Expected {exp}, got {res}"


@pytest.mark.parametrize(
    "ranges, exp",
    (
        ("3-5\n10-14\n16-20\n12-18\n\n", 14),
        ("18-100\n3-5\n10-14\n16-20\n12-18\n\n", 94),
        (
            "514636401848126-515021264549070\n284036251378482-284592982874520\n296164416018017-299046449889301\n283426891017632-284036251378482\n\n",
            4432988429119,
        ),
        (
            "514636401848126-515021264549070\n283426891017632-284592982874520\n296164416018017-299046449889301\n\n",
            4432988429119,
        ),
        (
            "514636401848126-515021264549070\n284036251378482-284592982874520\n296164416018017-299046449889301\n283426891017632-284036251378482\n343608343658787-349486968016855\n518754439264536-519443780540781\n203443194067628-203933432910977\n519443780540781-519633512362687\n210005855985412-210549428703488\n282811585081172-283522815708147\n282103439366027-282811585081172\n146191319211378-148928182943279\n\n",
            16284812830274,
        ),
        (
            "146191319211378-148928182943279\n203443194067628-203933432910977\n210005855985412-210549428703488\n282103439366027-282811585081172\n282811585081172-283522815708147\n283426891017632-284036251378482\n284036251378482-284592982874520\n296164416018017-299046449889301\n343608343658787-349486968016855\n514636401848126-515021264549070\n518754439264536-519443780540781\n519443780540781-519633512362687\n\n",
            16284812830274,
        ),
        (
            "146191319211378-148928182943279\n203443194067628-203933432910977\n210005855985412-210549428703488\n282103439366027-284592982874520\n296164416018017-299046449889301\n343608343658787-349486968016855\n514636401848126-515021264549070\n518754439264536-519633512362687\n\n",
            16284812830274,
        ),
        (
            "146191319211378-148928182943279\n203443194067628-203933432910977\n283426891017632-284592982874520\n296164416018017-299046449889301\n343608343658787-349486968016855\n514636401848126-515021264549070\n518754439264536-519633512362687\n\n",
            14417788460592,
        ),
        (REAL_DATA, 338693411431456),
    ),
)
def test_day_5_part_2(ranges, exp):
    assert (res := part_2(ranges)) == exp, f"Expected {exp}, got {res}"
